(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{400:function(t,s,a){"use strict";a.r(s);var m=a(9),c=Object(m.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("这篇文章原是我大一的线代课的作业，后来添了一点东西又成了微积分作业，再后来又添了亿点东西又成了计导作业。现在再修修补补又是一篇博客"),a("code",[t._v("o(*￣ ▽ ￣*)ブ")]),t._v("。")]),t._v(" "),a("p",[t._v("假设 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"2A7E"}})],1),a("mjx-mn",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"0"}})],1)],1)],1),t._v(" , 而 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"["}})],1),a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"l"}}),a("mjx-c",{attrs:{c:"o"}}),a("mjx-c",{attrs:{c:"g"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2061"}})],1),a("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[a("mjx-c",{attrs:{c:"x"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"]"}})],1)],1)],1),t._v(" 表示 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"l"}}),a("mjx-c",{attrs:{c:"o"}}),a("mjx-c",{attrs:{c:"g"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2061"}})],1),a("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[a("mjx-c",{attrs:{c:"x"}})],1)],1)],1),t._v(" 的整数部分, 设:")],1),t._v(" "),a("p"),a("p",[a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[a("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"3A6"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"("}})],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:")"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"="}})],1),a("mjx-mfrac",{attrs:{space:"4"}},[a("mjx-frac",{attrs:{type:"d"}},[a("mjx-num",[a("mjx-nstrut",{attrs:{type:"d"}}),a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"1"}})],1)],1),a("mjx-dbox",[a("mjx-dtable",[a("mjx-line",{attrs:{type:"d"}}),a("mjx-row",[a("mjx-den",[a("mjx-dstrut",{attrs:{type:"d"}}),a("mjx-mrow",[a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2"}})],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"3C0"}})],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"i"}})],1)],1)],1)],1)],1)],1)],1)],1),a("mjx-msubsup",{attrs:{space:"2"}},[a("mjx-mo",{staticClass:"mjx-lop",attrs:{noIC:"true"}},[a("mjx-c",{attrs:{c:"222B"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"-0.896em"}},[a("mjx-TeXAtom",{staticStyle:{"margin-left":"0.729em"},attrs:{size:"s"}},[a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"+"}})],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"i"}})],1),a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"221E"}})],1)],1),a("mjx-spacer",{staticStyle:{"margin-top":"1.455em"}}),a("mjx-TeXAtom",{attrs:{size:"s"}},[a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2212"}})],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"i"}})],1),a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"221E"}})],1)],1)],1)],1),a("mjx-mfrac",{attrs:{space:"2"}},[a("mjx-frac",{attrs:{type:"d"}},[a("mjx-num",[a("mjx-nstrut",{attrs:{type:"d"}}),a("mjx-mrow",[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-TeXAtom",{attrs:{size:"s"}},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"3C9"}})],1)],1)],1)],1),a("mjx-TeXAtom",[a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"d"}})],1)],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"3C9"}})],1)],1)],1),a("mjx-dbox",[a("mjx-dtable",[a("mjx-line",{attrs:{type:"d"}}),a("mjx-row",[a("mjx-den",[a("mjx-dstrut",{attrs:{type:"d"}}),a("mjx-mrow",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"3C9"}})],1),a("mjx-msup",[a("mjx-mrow",[a("mjx-mo",{staticClass:"mjx-lop"},[a("mjx-c",{attrs:{c:"("}})],1),a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"1"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[a("mjx-c",{attrs:{c:"+"}})],1),a("mjx-mfrac",{attrs:{space:"3"}},[a("mjx-frac",[a("mjx-num",[a("mjx-nstrut"),a("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"3C9"}})],1)],1),a("mjx-dbox",[a("mjx-dtable",[a("mjx-line"),a("mjx-row",[a("mjx-den",[a("mjx-dstrut"),a("mjx-mrow",{attrs:{size:"s"}},[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"("}})],1),a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"l"}}),a("mjx-c",{attrs:{c:"o"}}),a("mjx-c",{attrs:{c:"g"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2061"}})],1),a("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[a("mjx-c",{attrs:{c:"x"}})],1),a("mjx-msup",[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:")"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-TeXAtom",{attrs:{size:"s"}},[a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"1"}}),a("mjx-c",{attrs:{c:"."}}),a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1),a("mjx-mo",{staticClass:"mjx-lop"},[a("mjx-c",{attrs:{c:")"}})],1)],1),a("mjx-script",{staticStyle:{"vertical-align":"0.877em"}},[a("mjx-TeXAtom",{attrs:{size:"s"}},[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"["}})],1),a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"l"}}),a("mjx-c",{attrs:{c:"o"}}),a("mjx-c",{attrs:{c:"g"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2061"}})],1),a("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[a("mjx-c",{attrs:{c:"x"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"]"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"+"}})],1),a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:","}})],1),a("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[a("mjx-c",{attrs:{c:"x"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:">"}})],1),a("mjx-mn",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1),a("p"),t._v(" "),a("p",[t._v("显见， 当 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"0"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"2A7D"}})],1),a("mjx-mi",{staticClass:"mjx-i",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"2A7D"}})],1),a("mjx-mn",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1),t._v(" 时， 有 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"3A6"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"("}})],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:")"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"="}})],1),a("mjx-mn",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"0"}})],1)],1)],1),t._v(". 对于所有 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"2A7E"}})],1),a("mjx-mn",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"0"}})],1)],1)],1),t._v(", 则 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"3A6"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"("}})],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:")"}})],1)],1)],1),t._v(" 是一个非减函数.")],1),t._v(" "),a("p",[t._v("当 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"l"}}),a("mjx-c",{attrs:{c:"o"}}),a("mjx-c",{attrs:{c:"g"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2061"}})],1),a("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[a("mjx-c",{attrs:{c:"x"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"2A7E"}})],1),a("mjx-msup",[a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"1"}}),a("mjx-c",{attrs:{c:"0"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.393em"}},[a("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"4"}})],1)],1)],1)],1)],1),t._v(" 及 "),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:" MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"2A7E"}})],1),a("mjx-msup",{attrs:{space:"4"}},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"e"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-TeXAtom",{attrs:{size:"s"}},[a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2"}})],1),a("mjx-msup",[a("mjx-TeXAtom",[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"("}})],1),a("mjx-mi",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"l"}}),a("mjx-c",{attrs:{c:"o"}}),a("mjx-c",{attrs:{c:"g"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2061"}})],1),a("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[a("mjx-c",{attrs:{c:"x"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:")"}})],1)],1),a("mjx-script",{staticStyle:{"vertical-align":"0.477em"}},[a("mjx-TeXAtom",{attrs:{size:"s"}},[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2212"}})],1),a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"0"}}),a("mjx-c",{attrs:{c:"."}}),a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1)],1)],1)],1)],1),t._v(" 时， 则有:")],1),t._v(" "),a("p"),a("p",[a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[a("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"1"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[a("mjx-c",{attrs:{c:"2212"}})],1),a("mjx-msup",{attrs:{space:"3"}},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"x"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.413em"}},[a("mjx-TeXAtom",{attrs:{size:"s"}},[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"2212"}})],1),a("mjx-mn",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"0"}}),a("mjx-c",{attrs:{c:"."}}),a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"2A7D"}})],1),a("mjx-mi",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"3A6"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"("}})],1),a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"y"}})],1),a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:")"}})],1),a("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"2A7D"}})],1),a("mjx-mn",{staticClass:"mjx-n",attrs:{space:"4"}},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1),a("p"),t._v(" "),a("h2",{attrs:{id:"框架"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#框架"}},[t._v("#")]),t._v(" 框架")]),t._v(" "),a("p",[t._v("本文我们将只使用 STL 来实现一个最简单的手写数字识别（被誉为深度学习的 Hello world），之所以用简单的例子是因为难的我不会"),a("code",[t._v("(～￣ ▽ ￣)～")]),t._v("，或者也可以说是因为简单的例子比较能够看到问题的本质。")]),t._v(" "),a("p",[t._v("那么进入正题，我们首先列出一个框架，然后逢山开路，遇水造桥。我们知道深度学习涉及大量矩阵运算，因此我们首先需要实现一个矩阵类以表示矩阵及其运算。我们知道 python 中的线性代数库 numpy 的矩阵运算底层就是用 c 实现。一种实现是使用模板的，另一种是不使用模板的。两种实现各有利弊，如果使用模板将更符合数学的直觉——矩阵应该是不能随意改变形状的，并且许多行数和列数的匹配问题（比如矩阵乘法的行列匹配关系）可以在编译时发现；而不用模板的话可以更轻松地实现 reshape 的操作，并且可以更方便隐藏源代码。numpy 显然没有使用模板，而我当初写的时候没有考虑这么多，所以写成模板了"),a("code",[t._v("(´。＿。｀)")]),t._v("，然后就一直凑合用着。")]),t._v(" "),a("p",[t._v("然后，我们需要读取数据，我们知道深度学习是基于大数据的，没有数据就什么都没有。本文例子所用的数据来自于：http://yann.lecun.com/exdb/mnist/")]),t._v(" "),a("p",[t._v("如果做别的项目，互联网上其实也都有许多数据集可用使用，这就有待于聪明的你去发现了 "),a("code",[t._v("o(*￣ ▽ ￣*)ブ")]),t._v("。")]),t._v(" "),a("p",[t._v("有了数据集我们还需要读取，然后做一些处理，因此我们需要实现一个 Reader 类来读取数据。")]),t._v(" "),a("p",[t._v("之后，我们需要构建一个神经网络然后实现预测、训练等功能。")]),t._v(" "),a("p",[t._v("然后就是 main 用来调度。")]),t._v(" "),a("p",[t._v("那么本文以下的内容大概以此为主线展开：")]),t._v(" "),a("ul",[a("li",[t._v("实现 la::matrix")]),t._v(" "),a("li",[t._v("实现 Reader")]),t._v(" "),a("li",[t._v("实现 Framework")]),t._v(" "),a("li",[t._v("实现 main")])]),t._v(" "),a("p",[t._v("我实现的矩阵类放在名称空间 "),a("code",[t._v("la")]),t._v("（linear algebra）中，此外还包含全局的操作符重载和应用于矩阵的函数，而其它几个类并没有塞进名称空间里面，可能稍微有点违和。")]),t._v(" "),a("h2",{attrs:{id:"实现-la-matrix"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现-la-matrix"}},[t._v("#")]),t._v(" 实现 la::matrix")]),t._v(" "),a("p",[t._v("我们知道 python 中的线性代数库 "),a("code",[t._v("numpy")]),t._v(" 的矩阵运算底层就是用 C 实现。对于 C++的实现，我们有两种思路，一种实现是使用模板的，另一种是不使用模板的。两种实现各有利弊，如果使用模板将更符合数学的直觉——矩阵应该是不能随意改变形状的，并且许多行数和列数的匹配问题（比如矩阵乘法的行列匹配关系）可以在编译时发现；而不用模板的话可以更轻松地实现 "),a("code",[t._v("reshape")]),t._v(" 的操作，并且可以更方便隐藏源代码。我所采用的是模板类的方式，在编码风格上模仿了"),a("code",[t._v("STL")]),t._v("。")]),t._v(" "),a("p",[t._v("为了方便管理，我们使用一维数组存储数据并提供 "),a("code",[t._v("at")]),t._v(" 方法访问。为了应对不同的需求，诸如是否下标检查，是否 "),a("code",[t._v("const")]),t._v(" 访问，提供四种 "),a("code",[t._v("at")]),t._v(" 方法。为了防止堆栈空间不足而溢出，我们将其动态分配在堆上。\n此外还可以提供迭代器以供快速迭代。\n实现基本四则运算以及矩阵乘法，实现基本操作如转置，大多以操作符重载的形式实现。\n此外还有一些杂乱的功能，例如适用于矩阵的函数，本例用到的其他矩阵操作等。")]),t._v(" "),a("p",[t._v("代码请访问：")]),t._v(" "),a("h2",{attrs:{id:"实现-reader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现-reader"}},[t._v("#")]),t._v(" 实现 Reader")]),t._v(" "),a("p",[t._v("根据"),a("code",[t._v("mnist")]),t._v("页面的描述，我们编写一个类来读取此数据集。")]),t._v(" "),a("p",[t._v("根据描述，"),a("code",[t._v("img")]),t._v("数据的开头为四个 32 位"),a("code",[t._v("int")]),t._v("，我们将其读取并忽略。而"),a("code",[t._v("lab")]),t._v("数据开头为两个 32 位"),a("code",[t._v("int")]),t._v("，同样读取并忽略。如构造函数所示。")]),t._v(" "),a("p",[a("code",[t._v("img")]),t._v(" 数据为四位表示一个像素点，我们需要连续读取四个位并将其反转，读取这样的 784 个数字并且将其存储在矩阵中，然后返回。"),a("code",[t._v("lab")]),t._v(" 数据只需要读取一个数字并返回即可。")]),t._v(" "),a("p",[t._v("在"),a("code",[t._v("get_img")]),t._v("和"),a("code",[t._v("get_lab")]),t._v("函数中用"),a("code",[t._v("read")]),t._v("方法读取，"),a("code",[t._v("img")]),t._v("数据需要反转，所以添加"),a("code",[t._v("private")]),t._v("方法"),a("code",[t._v("reverse_32")]),t._v("。")]),t._v(" "),a("p",[t._v("代码请访问：")]),t._v(" "),a("h2",{attrs:{id:"实现-framework"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现-framework"}},[t._v("#")]),t._v(" 实现 Framework")]),t._v(" "),a("p",[t._v("接下来进行神经网络的实现，我们的神经网络非常简单，只有一个隐藏层，隐藏层也只有十个神经元。对此我们编写一个类实现。类包含 (b0)、(b1)、(w1)三个矩阵。此外还实现了预测"),a("code",[t._v("predict")]),t._v("和训练"),a("code",[t._v("train")]),t._v("的功能。")]),t._v(" "),a("p",[t._v("在构造函数中我们随机初始化(w1)矩阵，随机区间为([-\\sqrt{\\frac{6}{28 \\times 28 + 10}},\\sqrt{\\frac{6}{28 \\times 28 + 10}}])，(b0)、(b1)则全部为 (0)。")]),t._v(" "),a("p",[t._v("预测只需要根据式(5)进行即可。")]),t._v(" "),a("p",[t._v("代码请访问：")]),t._v(" "),a("p",[t._v("训练需要以"),a("code",[t._v("train_batch")]),t._v("为单位进行，我们以 100 个数据为一组对神经网络进行调整，总共 600 组。")]),t._v(" "),a("p",[t._v("代码请访问：")]),t._v(" "),a("p",[t._v("以下为类的声明：")]),t._v(" "),a("p",[t._v("代码请访问：")]),t._v(" "),a("h2",{attrs:{id:"实现-main"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现-main"}},[t._v("#")]),t._v(" 实现 main")]),t._v(" "),a("p",[a("code",[t._v("main")]),t._v(" 模块主要包含 "),a("code",[t._v("main")]),t._v(" 函数调度和正确率计算功能。")]),t._v(" "),a("p",[t._v("我们在 "),a("code",[t._v("main")]),t._v(" 函数中实例化神经网络，并进行训练，分别输出训练前和训练后的证确率。代码如下：")]),t._v(" "),a("p",[t._v("代码请访问：")]),t._v(" "),a("p",[t._v("正确率计算并不困难，我们只需要对比期望的结果和实际的结果，并计数即可，代码如下：")]),t._v(" "),a("p",[t._v("代码请访问：")]),t._v(" "),a("p",[a("img",{attrs:{src:"result.png",alt:"运行结果"}})]),t._v(" "),a("p",[t._v("如图为实验的结果，最终的正确率大概有 92%，虽然由于神经网络的结构过于简单，致使训练后的正确率并不高，但这样的结果也符合我们的预期。")])])}),[],!1,null,null,null);s.default=c.exports}}]);